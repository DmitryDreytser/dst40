Инструкция по компиляции/использованию.

В директории bin уже лежат скомпилированные файлы прошивки и программы.
Можно их загружать и запускать.

Если же есть желание внести изменения в прошивку или программу - ниже
приведена подробная инструкция - как это сделать.

Проект компилируется в Quartus II v14.0 и ARM DS-5. В других IDE
не проверялось.

Компиляция прошивки для FPGA:

1. Открываем файл проекта dst40.qpf в Quartus-е.
2. Запускаем Qsys: меню Tools -> Qsys.
3. Открываем проект Qsys: меню File -> Open -> входим в папку "source"
   и выбираем в ней файл "soc_system.qsys".
4. Закрываем окно "Open System Completed".
5. Запускаем генерацию HDL-файлов: нажимаем кнопку "Generate HDL..."
   в нижнем правом углу окна, а затем кнопку "Generate" в следующем
   открывшемся окне. Через некоторое время процесс завершится с парой
   предупреждений - игнорируем их. Закрываем окно "Generate Completed"
   и Qsys.
6. Запускаем компиляцию прошивки FPGA: меню Processing -> Start Compilation.
   Минут через 15 компиляция завершится с гигантским количеством
   предупреждений (446 в моём случае) - игнорируем их.
7. Закрываем Quartus.
8. Заходим в папку source и запускаем файл conv.bat - в результате
   в папке output_files создастся файл dst40.rbf.
   В bat-файле используется прямой путь до утилиты quartus_cpf.exe - если
   у Вас не такой - исправьте его на нужный.

Компиляция программы dst40:

1. Запускаем Eclipse из состава IDE ARM DS-5.
2. Открываем проект: меню File -> Import -> General -> Existing Projects into
   Workspace. Нажимаем Next.
3. В открывшемся окне Import справа от поля "Select root directory" нажимаем
   кнопку "Browse..." и выбираем папку software/dst40. Нажимаем кнопку
   "Finish".
4. Выбираем активную конфигурацию: кликаем правой кнопкой мышки по названию
   проекта dst40 в окне "Project Explorer", выбираем в открывшемся меню
   пункты "Build Configurations" -> "Set Active" -> Release.
5. В конфигурации проекта используются полные пути до папок с инклудами.
   Проверьте, что они ведут правильно: меню Project -> Properties.
   В окне свойств слева переходим по пунктам "C/C++ Build" -> Settings.
   В закладке "Tool Settings" переходим по пунктам "GCC C Compiler 4
   [arm-linux-gnueabihv]" -> Includes и проверяем правильность путей
   к папкам "embedded/ip/altera/hps/altera_hps/hwlib/include"
   и "embedded/ip/altera/hps/altera_hps/hwlib/include/soc_cv_av"
   из состава ARM DS-5.
5. Компилируем программу: меню Project -> "Build All". Программа должна
   скомпилироваться без предупреждений/ошибок. В результате в папке
   software/dst40/Release должен появиться файл dst40 без расширения,
   размером около 500 килобайт. Это и есть программа.

Использование:

1. Копируем файлы dst40.rbf и dst40 на MicroSD-карточку DE0-Nano-SoC
   в домашнюю директорию. Сделать это можно, например, с помощью SFTP-плагина
   для Total Commander.
2. Подключаемся к DE0-Nano-SoC терминалкой по SSH-каналу.
3. Заходим в домашнюю директорию.
4. Загружаем прошивку в FPGA:     cat dst40.rbf > /dev/fpga0
5. Меняем права программе:        chmod 744 dst40
6. Запускаем программу:           ./dst40
7. Вводим исходные данные, проверяем их, если всё корректно - отвечаем "Y".
8. Ждём завершения поиска.


ДИСКЛЕЙМЕР:

Все исходники раздаются "как есть". Используйте их на собственный
страх и риск. Если Вы с их помощью как-нибудь себе навредили (испортили
настроение, сожгли отладочную плату, взорвали автомобиль и т.д. и т.п.),
то я за это никакой ответственности не несу.
